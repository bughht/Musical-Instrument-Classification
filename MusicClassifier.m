function [Y,Xf,Af] = MusicClassifier(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Auto-generated by MATLAB, 25-Apr-2021 17:48:39.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = Qx12 matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = Qx10 matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-79.1923686181445;-71.8397127796509;-48.4384527676613;-45.4672813452127;-36.9406968771753;-51.2070122836369;-55.2172252315333;-25.995898733643;-29.3410485422751;-27.3158699034617;-22.6530838508633;-20.2137745994861];
x1_step1.gain = [0.0114519122595416;0.0164008224556604;0.0242300036075175;0.0243619455842358;0.0296745167668304;0.0271798891111202;0.0198893084210877;0.0327471264187208;0.0315534907473674;0.035032081192062;0.0436321771657524;0.0454428022768501];
x1_step1.ymin = -1;

% Layer 1
b1 = [-3.0410352672380063233;-3.1158275139398265985;2.8859168825052377017;2.0125203012421954973;3.1409202102974367321;-3.5923952115920467776;-3.3224625289704530218;-1.878685314456945088;3.6224046193141825611;-1.818489531389792413;-0.45675503392460614638;1.8729627464133626891;2.9742405017636341924;0.19270585122960379176;-2.092808578274568454;4.0916488398618637845;-3.5242108437212995575;0.36937796159671898444;4.3648386642596994633;1.7800959945553791464;-1.8942214756169866163;-1.5244546101796625504;-1.9959038876748693703;-4.0198724849928195724;3.0281249094580688919;2.5265638097997160649;0.69322744540042124939;-1.2458061734922705188;-2.7675989487894221419;2.6940197361480437976;-1.494847259913143489;-2.1725966122483768572;-4.0084681099893542111;2.8955943005280140312;3.6970420338474285771;2.8291462471749251328;-2.9876011765158572153;-0.4241027182074839641;5.7519878114235289956;0.21645522579064352398;0.39300006195454295632;0.12491447241340601637;-0.8411856116175859821;-0.78588534613860827616;-3.8556103710344600266;3.1368503814063397606;-2.6089433940256716582;-1.8919636094098049028;0.33141734233227915229;-1.3787789013637772317;-1.2445745467168309872;0.62697646733091993987;1.7728202159458397169;1.1058631808162320276;-1.8376499577438945021;-1.6003519616613310905;-2.1883474546447194697;-1.243818334851900298;-0.099102365754305546397;2.1141977786244932069;-1.2730824145393879743;2.8766161297287342613;-0.97418448797323053956;2.7529595859562854265;-1.7565069382909410667;2.9301896864347067861;0.80028741565922911771;5.3829030170140130807;-1.6351432294571721648;-1.5307110602478395389;-1.9721390001911160983;3.3848343555919919723;-1.1761925484629536243;0.19532904966211417364;1.3126122437312857105;3.3901019505717986391;-0.47043886636490978015;-0.30126355138705412928;-0.85369632024373609536;2.2020242866153556527;-0.12858273131815506352;1.9067628164240810751;4.2826829437182141191;1.6860492209466555469;-2.1272478050084568935;-2.1811780909125886296;-1.8182942737603891015;2.1846011294960701044;-3.1582626210866528993;2.0299379781583661853;-2.6297663630326351125;-1.9596255072639101602;-2.3136535212357265401;-3.2814095068870363647;3.3393783800656762217;2.1087443717339335869;2.2976454150548799582;-2.3029716415182019951;2.8383772531192628108;2.8490757201969976187];
IW1_1 = [0.39980662883179490796 0.38498189999772519654 0.44212536005304375886 -0.44673781464616624248 1.1603194794839866155 0.47480377674149415457 -0.88838926527414041612 0.37209439137349620275 -0.52474330491419440836 0.58679444992689211436 -0.34922373261862094118 0.421043821871581736;-0.28442956213028847134 -0.051076323770511293521 -0.32262525219587340208 0.206073669502593676 0.27559951465640480928 -0.76787725100854964388 0.37922628710892142267 -0.69614369814494514443 0.2644998646679745935 -0.32412814031439285412 -0.30730004029505048058 0.33121083892683661487;-1.7344029949270198809 0.99898108720732592403 3.0732587307993566306 -2.5780746665336859991 3.0469073918547109336 -2.9070803822019710694 1.5971283816649886056 2.4055327541621540632 -3.5190739669039690085 0.89114666575336876075 -0.22947032501399028392 -1.1963195271593451974;-0.60275020549447211327 -0.72657264490095252452 0.5624569719097568532 -1.2307980682600523359 0.34589713540083599774 0.31582414820213727813 -0.23225104152937450785 -0.16025763566905332214 0.66984062328206028791 0.12022339638094221848 1.2396093706656226008 1.475950213951887191;-0.36659562897198522124 2.0847947985819730299 -1.3511948735262591104 0.086909123000799642922 -2.07877156000745833 -2.8246354262378070565 1.8308666740430739051 0.93447557421298277358 3.3199692454412583764 -0.63524886966443916414 -4.2796687621716227312 1.1792603869576694375;5.1519985926716520552 -7.1291791561855051285 6.0984613815866044462 -2.5808166086537718265 -0.2291935097265175858 2.7429188342895165498 -1.9877677766681669524 0.63065654187290154375 1.7234731738828843461 -1.9183720394468986026 0.22796903191851061732 -0.33519093966847851584;0.51187896215041606141 -0.45205067484567768021 -0.036728761862983079489 -0.67895642774441600231 -0.40014640335637940982 -0.53034040512575941761 -0.18120458429750380125 0.090815111056031891379 0.59705938785238998889 1.4481651029203095327 -0.88216359423421175645 -0.082570113403461278812;0.1754212157524778215 1.9739600866455919714 3.2178580046919980084 2.679918701166670747 -3.1613317211895606285 0.66816100663413269256 -4.3955005616019651171 -0.53428469573247894253 -1.2292327535444707021 -3.5547031097213985795 3.5091042886969425751 1.8518736759526295277;-0.36671619789490739194 -0.3978299052300123817 0.59035944377719384857 -1.0265107064204399556 0.13222511854283325317 0.28401422984423391194 0.074946772334996275555 0.4387685533441899044 -0.12822342654738444478 -0.35084441954378048356 0.044392716750733821063 -0.38621153616713205237;-0.0051834801908467540571 -0.95337160057760361731 1.0147636285098327047 3.7387322163088989591 -4.4694262534208899496 1.2172711148080175292 1.2255948833173615498 1.116764751591596605 -0.63852090268178640642 -0.085470586408522841726 -3.176993345407443492 0.65544357127245145289;1.8395772998312922564 1.4497945219256824778 1.1313043437639536126 0.1525027164666039603 0.8882285414232680143 0.26529122575758229408 -1.8271309162645592572 0.86389753991744056005 -2.669270194022346665 1.7167134941212658372 0.80486208538114156763 0.7147861657887409903;-0.65349821548492637024 0.84289153875265898641 -1.2078846615552256694 0.0099169446127384021372 0.18627729302955323143 0.090403653024208788236 0.29061465686207116343 -0.45051807872417759526 -0.52689223525551176497 0.56786885873050274576 -0.74546830294384902604 1.4411729804541995037;-2.5371506180295746447 3.9626971994918371855 -4.6206350591474052436 2.8164536896583034498 0.24472127247123345861 -1.385103108225463675 1.670296242080658855 1.3588744302399147212 -2.4076836127641416674 -0.36572737449225134476 4.8634673450219310098 -3.9246878070781177072;-0.69361215238847140352 -1.9173324840346712694 -0.37160631307196634321 3.2750017967636830818 1.7290451435944220737 1.9605589114919308447 -2.7327012672482222655 -0.59206166455170072815 -4.5773602576937877373 -5.6430985425952187029 5.3452642529621501311 0.75109573038843335802;4.6579453262036514261 -0.62099614720553975022 -0.45746852692535339147 0.032716612285755342082 -4.0654493419080504069 2.2888949856911913194 2.3445519314737501837 -1.2551504519724328013 1.4964891155166983872 2.0617495178340958795 -1.0553041098667876874 0.57909085859949005481;0.4254836687043066501 0.39056510611076089567 -0.53496304779100189997 1.1692737595857607413 -0.63201672525956009707 0.001807231946469175024 0.63680592659259660504 -0.61725540148154212083 -0.16739938451018313015 -0.25940208350799170978 0.55828032398023652583 -1.3698495359270901339;3.2079616064910894124 0.77732567862610257858 0.97776388203173048019 0.97484955991970534406 -1.7748576654517818074 0.47122563911818449167 -1.5719538237608763342 -0.50736004219220853795 -0.096200441374500858527 -0.76010425439098694422 -0.20180541104413618481 -2.9002084825885954267;4.4370055121976035295 -2.234760130058891292 3.4551825460474177021 -3.4941946615483074901 -0.16517238608691131585 0.1579398692248978886 -0.26699079897244792914 -0.51990798514853031609 -0.19549396385919687313 -4.583515817714007845 2.4678823524716881899 0.64532193802483184264;0.93188733507042720294 -1.0172705794671077495 -0.63776256278693821411 -1.4368966155532407747 -1.0596438396433200957 1.8763400048238583206 -1.2463460934934305069 -1.4263771335129757922 -1.9557321477571600887 -0.61412344034730992348 -0.95707602312322581639 1.3301243463109657661;-2.8221359303728155155 -1.8963128523321468588 -2.1107952542538988006 5.2446038694173546801 2.1433338001366775138 -1.4312651472491992877 -4.4673045345455735244 -4.8241643417513619951 1.197620898451030591 -1.0112576875063032933 -0.82171028288467884426 -0.60556643775939489327;3.5826111848127286663 -0.23281476045874099912 4.0059929699838230377 1.5427203161826263944 2.1768990539449082355 -0.23428683076474429714 1.6689026942145472887 -0.65066722738178595087 -1.8402486223328820003 -1.7082150278799905774 -2.7812440649319407626 -2.7099149309970433919;4.3933292417220854986 1.1297148181931477851 4.2233413317061172521 0.54073721670918106774 -0.059371863125837254227 -4.3386254675519859703 -0.21011967515863277933 -0.39769957491615864908 -1.0456014315435866457 -2.0729194677900539823 0.12410394643598442188 5.4569629943662025795;3.4321217113509359109 2.3985880735059463831 0.095577331453867930833 -5.2679291705879993657 1.8026050024930648785 3.9028564519294235424 -6.5879168701857704349 0.63834189069196989319 1.0252754616684671696 -1.8142613870489452399 -3.4731005512961079518 2.9315884522062316542;5.3011192832073792403 -4.0670007802742125236 0.033092949849192386524 -3.1031522864084561952 2.8480105391992789343 0.71890113688610002285 0.21506868433807219132 1.6645112415999467892 -1.0532824041258219694 0.12491249314803999637 1.4108476590780001381 -3.2868333710427628525;-0.017659751660824389574 0.96557645735079489224 -1.0047007454963321482 0.036281136167002153714 -0.5483746166363359098 1.5711461158264381499 1.4152971309453732385 -3.900712223861161565 2.1766120514328908264 -1.2742481793941917712 1.6515732672792544644 -0.74621782390113455818;1.1775630444028037935 3.3872445562990707302 1.9328220617496525424 1.929591295453848776 0.85629752839061723524 2.454184669454960499 1.2652763339052537361 1.8138012233516498384 -3.1781115135336079902 -0.38251653532979257299 0.13023887361095765058 -0.12955758787829307899;-6.5800737910852733492 -1.2475605635414925842 -3.7287774234923070082 -0.44899601860674243081 -3.8787077272845009723 1.1288792613125677722 -1.9085907315327921285 -2.8623032551105347387 -2.8104161014005919483 0.30779017096652511176 -0.063023127471433779134 -2.1095806714530209725;-0.082817957680031265011 -5.6405047091714894947 3.7215502593228273476 -1.1575192144625219282 2.3964424776353401292 -4.2267997885152812643 4.9938690492252302278 -3.1013627306562980834 1.0889653437785333789 -0.0075045088521127813891 -0.20700644318729150006 0.26498584939945796224;1.2043264583934707446 -1.6173616981664880043 -0.69040698114141940689 -0.5192435139819148171 0.91607450358909148225 -0.025663550729279043655 5.2968153945420954898 0.85959287913289972316 -3.7910302835814722044 0.30947199260806490528 0.17376097614313959494 3.6673911669370191646;-2.9092860906327540071 0.12196248271993530288 1.5516732339978935862 -5.4152609327345144763 -1.0162308807934887778 1.3131974572660776168 -2.3307828752849313325 0.11220582973018317086 -1.1058899305302822835 -1.851961464308686578 0.062421380604238178857 -1.8548519495458661854;1.4810099646718082322 3.9004078006097295805 1.9878890220233023101 -1.2634363085149011852 -2.6010485950248161124 -3.8727220199428771252 -2.2592916074938638182 -0.021188570954149509723 3.3624609329185535245 4.5627987447399513954 4.1098732136708822082 2.791831612679174679;-1.5277192429306245547 -0.17241293384734956984 8.4671868397690044361 -1.9906895165399787206 -0.25175414194270229196 0.86215377196724307662 -1.2812180691334278393 0.046174284470612621256 2.8837452579286253496 3.3457850442277039527 0.19247107917795910903 0.86286841929410518226;6.131801888651401633 -2.1417077467047533901 -3.2880144566966746922 5.9653758824805089844 -3.3616077439774647573 0.3286621015279598268 -1.8162904325813800099 -0.35619595770168427373 -1.7789382843503871445 -0.0020214856282278485973 0.12877983172949569735 1.7008007013039823097;3.3742196541731619419 3.6320294190779969234 -1.3426704687642514457 -0.14869097019703433893 1.5763287562729528801 2.4209673809985265969 -0.96975159620982076536 2.4773564364897140422 -0.81647422838407224255 2.7176458004670998037 -0.60584502827226416333 2.2341308550727569937;-5.3911915617163881365 2.1490184324200107824 0.08084412350710472317 1.9824763568956347282 -1.2860530874931781486 1.9868112315848009963 1.343398932391708378 2.5182474808015213874 -1.7352479944051084626 1.0437833305060444378 -2.2744938037324047286 -0.3081719917331756653;0.71235467013677322701 -0.51793725386648059583 -0.4570043289087923899 1.2178686479127438513 -0.094563742326040714503 0.061625173040664130153 -0.15123264337498604215 0.092625627412996833221 0.914321820971139676 -1.3951780254560788297 0.13627157486678642684 -0.9223724958431329668;0.038486743611992370317 6.2757121300100582317 4.5733891089697760179 0.41953005005335120003 -1.0479762118359534639 2.6370397423948856996 -0.28373262473069532641 -0.17595511320798387644 -2.4624635329422299712 1.3803445309152626574 -1.274340583736493393 -3.5968753521789658123;-1.3160179127651225883 -0.48659346591687824279 -2.9217910684563919155 -2.5175396478798863775 0.02678135368847719272 4.4731665747062443472 8.0415275139732553811 -4.2809716114592077929 -2.5081782500047169471 1.0820521838023029471 1.7842966292959046015 -0.067454925664616277592;-6.8663191092511537406 7.435216890258278255 -7.0686461903845279053 3.2282835529719879908 -0.76188922046645990438 2.4190230903476361846 -5.5975580011711993933 4.8463080612666082914 -3.1406463105914697032 0.99184770081442763523 0.068560754354098016328 -0.86761759372760194342;2.8204511765597244377 -2.2899911485003010547 2.1431431054667084979 -0.29406898798422381747 0.89150426528254778091 1.5552103706259374771 -1.5904043332129411681 1.3734662559931691828 -2.0583336911552398973 0.87365116476763682307 0.21937645611474992924 -0.15035130269593757757;2.1312044963403544706 2.2695059275763029838 -4.0741319063367411601 0.23197855310412412999 -0.88172607778371292486 -0.4582280258278861873 -0.24850008101900980528 -3.3361745388727972461 1.7964571487575407005 -3.4178111305186078539 1.3733578278474141143 1.4502531636741908816;4.4303791309399001008 -4.365479499336024638 -1.7874209741295374876 0.10014113081509838643 1.6638169836709786331 -1.3782284555144805882 1.3142189054172288554 -1.1159074224362348637 -0.34111485496226412462 0.3594132132860835549 2.362556652310851657 -1.0580366169192594317;2.0731087764105402549 4.7034253450380365535 -1.4950307041587567181 -0.10657429445865591877 1.8754412668685864762 -1.6052356833038932127 -2.9227017064900429055 -0.40819868106671908237 -4.5934699963990563987 0.86355610860379161675 -1.4185452351187763931 -0.6287589545231503374;-0.68400477794106195883 -2.1378599352572833503 1.899757423193072281 4.5231587149124381497 0.53588680105892461114 -1.9133915903600624553 4.0224024443149524188 0.3710586245299083985 -1.8148017686481845434 1.5767052696396597344 1.9091835756594637274 -2.3914692101451744399;5.0019311086348530182 -6.0095605077665403826 -0.18751347118856520613 3.4310009375145091859 -5.2433847194662623892 4.3812728950594808097 0.29336143024891958575 0.067563957204161986803 1.8115308250592545569 -2.1991128077248127681 2.679481169284673836 -1.0231813179103552702;4.2176771878442576025 2.2764122671832058842 -1.7708880068009058562 -0.82775561007243780853 -1.0188993143118609819 4.1215088974207727546 0.27590961689499676757 0.065427507000956647287 1.5014814486144965056 0.018336098676575002947 1.0308620715571876758 2.3481881452616164552;0.051814829531849390665 -2.0503615551546854334 5.9732128905415926567 -5.0441125983727443938 1.0693780905705947415 0.47683100392324695438 1.8924273597314920092 -0.85589076169711841846 3.6486803145497028744 -1.6822569400014180108 -0.15608250245499638575 -0.22749975048025103397;6.1669808242393990838 0.74227432517252223132 -1.6778655022723725221 -2.3435141016519480672 1.3545839380918052175 1.146932382074177692 -2.6918671067644930339 -1.0316373032803438647 3.0920601559617479914 -0.95596814533328222652 1.5313989301579036262 -1.860352861887658138;-6.8676234823230162263 -1.2937798305247949493 -2.2542349936855066161 0.31837825232519212371 -0.57412138993747097171 -2.7992699932930764639 -1.6563654402882290739 -0.014096003463797279406 2.3490122396384944814 -1.7065912404352614473 -0.51188217764748267236 1.8298853900447338283;-2.1870054692134086594 0.96175477553606136816 -0.30897993281449798175 0.3394082817591083101 1.0279758108611585232 -1.9619197296735402247 -4.9298035874790429034 1.3459443778978821271 -0.37764989292374251395 0.50974509201772943978 1.1275569156481923816 2.0904891211133054263;2.284856338084981342 -1.2374472215806224806 1.3316125603910200503 0.51312870061148907475 -0.060946527706145614545 2.5447042229774052835 0.29382285122973184066 1.3087283906570097436 -0.85295866227021588379 1.1440078587712887437 0.31232818685295543615 -1.5230567027416337389;4.0572687118490549096 -3.5362786978095339663 -1.6610346786403151764 -1.2008042065929114273 0.078923387028817043598 -1.6259829810185297827 3.4962376921624276349 -0.90435426218698133916 -1.0212464824818752174 1.0191594681662468069 1.0823828418595478063 1.0985825675927312073;4.9516684227440803667 -0.1558934249803518024 -0.34450925146668542887 -0.26846501244844844791 -0.97147587878767283076 1.0140179024821167619 0.31549019358277191616 -0.92729600483248375564 1.0848527728772745515 -1.1808483802812972385 1.0286737112010235773 -4.2086174120391959264;-1.1705748349651865503 0.10069698699102987149 -0.49921048087623143275 -2.562302387958367067 -1.1178589070540765338 1.5551897312733260481 1.0373540682473125774 -0.90139010791475193685 1.3096769913653405482 0.22275436096431369681 -0.59918193966052668564 2.2746893785877477789;-0.0012462832030345986217 -2.1690257645886079629 -0.11057680401317915297 -3.4418869412706896149 0.77648803876518002198 1.9660233027034914599 -1.7229671288556678288 2.4499353832071557591 -0.4760858256444714387 0.92091358996801075953 -0.62024168720119099429 1.1133874805765715532;1.4767867078826839577 3.0497459405836333524 2.9032892987229064197 -0.8083065415917586316 3.2862171497955539046 1.6483012072756231259 -0.10436455932411099756 1.0716462433325515402 -2.1591606667803358022 -0.78782526840931221823 -0.47982075975194787842 -0.98756217946356961157;-5.5588305739197361177 -3.8154954245232790555 0.015752642143551147391 -0.13561936725225620659 -2.7621137275240763564 1.7238157360661965356 -0.995696391343705689 1.2956441155062117243 -1.1463236685311037899 -1.0482546013650571037 0.20306858273704725404 0.086470234549444413563;-0.48978585914585937022 -1.1824881661340314043 1.8173469653640199617 -0.14738690521770581032 3.3829373014791332963 -2.2657119255465634211 3.2052231588675348384 0.50091099136025118987 1.6168396204634221114 1.855725016308655384 1.0633607936625184553 0.29004448318586534272;-2.5307789688555790697 2.72844201135810005 -1.4991127332166642727 -2.2762270031882452237 2.6408884155831739982 -1.8536890943023649481 4.934248562123086046 2.7550117240860623191 1.142796154490716809 1.2124760932481628561 1.0069553971845452978 0.90922036886136103906;-1.5650551913849315433 -1.6374164612192734225 -0.20925807476672697582 -2.802460952854771481 -3.3390533119357312941 -0.66923127781134172931 1.4370231769678332157 -0.34374224805333852828 -2.2895749330310142255 -0.76209485245708696866 -1.160760935689856943 -0.51031234799497127153;0.88013307050258571262 1.8079020853985645623 -4.1834115974879813038 5.1581969964320615318 -2.3486097149767064529 0.99179408238256727692 -4.6623727960899401523 2.6277689680933224992 -2.5038117064278053725 2.5005899268544364844 -0.68724988112154394848 0.26382188291465097363;-2.93233464976164937 5.5101528896908931188 -4.1737573171186532761 2.1554003678550812673 -0.66553769355124425822 -0.0069443445220531731243 3.4043468874958278114 -2.0523509146045753049 4.1805429693871216656 -3.4332999019194607726 0.56447047303942721186 -0.004404971051637902868;1.2853731271853501283 3.6369783438778413576 2.0802167499923900351 -0.64529812465395386401 -1.7164999137700087672 -3.4896497548983398396 -0.035202511622404272784 -1.9544212886051206546 -1.3679979427881130416 3.7531129416235131657 4.0729220866731168371 -4.103528259448157911;-4.181803186441483966 7.2082339085522750821 -6.2401768755494968488 4.3386953705808455339 -2.1855416136895144952 0.8046382874296990062 1.4317960817441064414 0.27154215339030179921 0.66380923595035135065 -0.86187813715800454251 -0.49086650635059109193 -0.8641269846248457176;-2.3961314939096927112 1.1116920472717461976 2.6884835483241538157 2.5509788009307019507 -0.88970789117777426824 2.4880715377807294253 1.1556705082157248121 -1.7848729878512348268 2.1541692487308021775 -0.7826203378193320459 1.0864419811241525782 1.3026051688115387606;-0.88700635870293065288 -0.084339278921587559901 -2.1126209342785253753 -0.057761909884467214915 4.0838392783107364536 2.7757069026489937791 -2.7395003327560032425 -2.7112785932268002043 6.5123737308677718261 -1.7125824087862204781 -1.5676929304812297072 2.1408755782977051396;0.55729151866973380969 1.0305399183805246111 -1.5195592524059304829 -5.6490334821795666898 -1.1003878460508063064 1.4864270181374497071 6.5628817427793046946 5.1747762269715948946 -1.5408757221567324081 -4.2151410576397640995 -0.25162057155668438035 2.6935719775704591861;-2.8676581541118344454 7.6660362711336329511 -2.8728286830882212577 -2.258150580856926215 1.9062492663813408456 -0.53326198234756594374 -2.0656018713786443719 -0.96445835923258171896 3.3601606013168217046 -3.3801303999133613942 0.93733599825164282127 1.1773815059763748092;-3.1153884765906965093 -4.1709720599787560857 -1.8850637301411186098 3.9860769902457264813 2.5626808801256419912 1.0252897375888123666 2.3607882273334555023 1.6736906098069863624 -1.2680154730480817094 -3.0751553996250815537 -1.818978176662674251 0.023599197828771505125;-0.64686812542251648228 -1.9202326161546365846 1.1457673258733991339 -0.73403692963577282793 1.3762013040799512265 0.78316137690355114298 -1.4141164548972058324 -4.0964092801847904468 1.0135037535373241369 3.1872305786005274975 -0.84718279736048418549 4.040543808956232219;-1.6979349377700858614 -3.2972225705435285192 6.5283048985436460399 -5.4506216803667113524 0.81196049738522635408 -0.71872628753345979558 0.64724523831669023011 2.729950223498115669 -1.1443559850964410973 0.38480885246065871241 0.37647213400861356813 -3.0243247431600641661;1.4389545255337323759 -0.8307242344389107469 -0.3427249149234117831 -1.5470847102333176171 1.7712555797665243684 -2.6134289110216237795 1.1386389904597598033 0.62260616264527135488 6.493997951471923713 0.61156924917912847128 1.7340830076843833929 0.15803074128426375378;0.10477221269414956073 1.2941211657088556031 1.7636701258653098012 2.6227048412746909456 -0.27845024117645594819 4.1508332655323831872 4.224791626968937841 0.91767710792162660027 1.7184304389064188889 1.7316397718129661332 0.04840370574387908853 1.3206475410728923947;1.417585069964423683 -2.5801651923062172145 -1.7092236281530948094 1.9558254558889232033 1.2835941788360907267 -3.5986426373449575955 -0.76443955189847057063 0.27352252575569740989 -0.38737455161611389354 -0.81013665416104263528 -0.07599520886187113855 0.11234246520617230392;1.6581157604229033176 -2.4679342701033721852 -5.083040058193851074 -1.9802222643615421394 1.8378328092455455955 -1.1366567268030296489 0.10105031819641986657 -3.3478350024798406714 0.25507469244710984091 -1.5328754828635335894 -3.1616353811132822393 -1.1897367705959709383;-1.8538306375167090678 -0.67879652759715358723 1.3739540851222036277 -3.7477572286094011922 -4.9527142638562873245 1.2591580026348117016 1.5964951660517223697 0.27890211349173849031 -3.1509464075202124889 4.4009112307014151 1.2894426236646292505 0.57909938602892563342;-2.709083200868105834 -2.8557244705915545424 -1.3867962503531316987 -3.2264225178684937667 -1.0589657297915588963 -2.7244590587617874 -2.5425110298552593413 -0.38922370410253043227 -1.2912632329255651076 0.15776038704843192706 -2.198340010952172463 -0.96773906733242265332;-2.6562651468583129422 -2.7449954612088318662 -1.8307117726688302284 -1.4443538279753045384 -1.2723779166888260495 -0.26597832014885119944 1.4216365524146294952 0.34690040511564917969 3.4187510894631225611 1.7692654954831714686 4.312898350622080379 0.93041291985963503475;-4.2398703824031311882 -0.1289056733241241981 -1.2078190136918620645 5.2200252815749141888 -1.234402074903329094 -1.1427444696536404045 4.0651214939031312667 -2.556728593800671856 3.6038375969823910339 -3.0077582143999812558 1.385168613922735048 -2.7309392455983330095;-1.5582046013599784029 6.8710232361107212995 -2.3971002209423426521 -1.4912876201573372903 -3.0352971480500490209 0.077615889892257691751 0.56918681315867825088 -3.1604056792686616717 -0.06837314794592345979 -1.8038902900286144515 0.098412792880594290867 0.91552855341802075184;-0.62865687504070999481 -0.58744945667016346125 3.1503240721200582719 -2.0921174946874478984 -0.046655322946706122289 0.69649655110216257548 -6.0506491704631546469 3.9296131343515643408 -0.089502010818750588061 -0.99186138552036928751 0.58729995603677953575 1.2744510750660251741;1.4072384116892100447 -1.6773430987294630778 0.49180547517199585394 -1.0365262399829626716 0.40415005677745019508 -0.52976286779500758595 -0.12756434237745437055 -0.26451180632391568803 0.16329945634155185186 -0.036196121469709963137 0.17240109308626910822 -0.29103938877055707257;1.558781268055439595 5.5821124755335693735 -2.6253337690417781758 -2.4466072730794805601 1.3118591058676944971 0.83213841407035427089 -4.0482508411152764438 2.4507394509865996213 -1.5044492765379535726 -1.3635798581238516292 3.4817074372566114704 0.46896443725174186135;2.5627230268263478941 -0.23539082533756122695 -0.70579473290847072331 2.482101548521725487 0.72848471687175553324 2.7925867468429150797 -4.4650991228870218208 -3.5885676705539619746 -1.2039972532370244451 1.8271068347572889667 1.6511699791843137408 -1.8438869559157893274;0.95799232535290201884 2.7817119432165902104 3.2234682298932479938 3.0080411585340138814 1.1620747430287168278 -0.6730921826896574256 -0.91411789948560651098 -2.3786255939177580743 -3.8847343837347607653 -2.5855938908573961044 -2.2947027221612295023 -1.9132490338676961805;-1.2400856276177167903 -3.249323804420702011 -5.015234494361393125 -1.9655933943231147509 5.2059993434702827031 5.7908370249140208585 -1.7737882476086723749 -3.105392709455000233 2.8311802612273844204 2.3389031970393814319 -1.3198583165452033583 -0.71183913667866827168;-3.4382888220693672565 -0.40108927250030357303 -3.8410496716343485168 0.82116808761708848241 1.0124521179079650768 1.5300989181105526526 1.0073902662091738236 2.284863026387050855 -0.28722603801344664953 0.79146716670125238924 0.92342661424005456627 3.3163387579770389202;0.74967671806588709327 -0.98948670479344413842 -0.062829404517766140881 0.24834470087027354923 -1.2008854364534564674 0.71867951821932951617 -0.0076325755010913940227 0.11731045331965223033 -0.040398055876455472857 -0.31414765536986410943 0.58588444721123078551 -0.36219726303728383421;1.1622100552864562673 0.18287590820177423989 -4.5438038651914114396 2.2169034316489919512 -2.434534467534263058 2.6676355298475926681 4.9178480558839350323 -0.58436069099592402587 -1.0100855997250373086 3.5645199274634276065 -1.4692021897290605814 0.59230038536226581325;2.0814566999134940239 0.34833682017013756216 0.026707693009009689927 0.37314125361596772734 -0.61272872714007164952 0.028371664327657759863 -1.2873833135909555914 -0.59126101756874138715 -0.78016161358526259217 -0.62937846858692747531 -0.44365803042789564437 -0.90604502570796308092;-2.2365136838849997147 -2.470793831021353526 -3.0375885933219910484 0.63430149863191764847 -0.62228616019791960223 0.98330106759380087045 2.0867296780186834759 1.5355790180353907637 -0.095373306726965756397 0.57740336085266930066 -0.81006201708016889462 -0.9317493613507301653;-1.1432489589292698096 -0.25740729343308121901 0.62783789578729898295 1.4483116249584391255 0.022539608717401602572 2.6758636103445434529 1.7000009390739261317 -3.6915975321566922851 -2.0492003491980734786 4.4311030367403354546 -2.0389312326932991226 -1.7029120202045799903;-0.17838000478595189557 -4.8677690235430723931 -0.96988573306887937431 -0.49734157262250322518 1.5638492769598937304 -2.1853162672088082275 1.2501499097380384118 -0.044186211238295740322 -2.3234475593671497506 4.069150193919912617 -0.77358972650362756163 4.6852947016246417888;-0.34574055708373646612 -0.52243727615027535371 -1.1953676649400408749 0.50318341025633472885 0.3160321787070128341 -0.62679166755311466197 0.020101693126237912823 0.11278860057419830276 0.29207147987995651928 0.20961041670987740071 0.64300449973063089626 0.51261955074971976565;-0.020012801583576114717 -0.49777710365190258601 0.31784834388595056831 -0.34002543909569910019 -0.58933981297126369903 0.6732844549168803816 0.07255913918800474538 -0.16132060028098191284 0.78244978502708306678 0.014174293407209215268 0.76735656342583702383 0.29055198031824758242;-0.98039652251044984155 -0.55241002711886189047 -2.1675120220240216007 -0.65777242394334334286 0.74328503137092261088 -0.85049097464049783213 0.1475523528477795665 -0.58114439070754286831 -1.0201343950696037943 0.97649066048916821625 -0.53549192805822976027 1.1150479362509455594;1.1730125001269395835 0.50694742142886506375 1.0097675309002260846 0.67112892874035345869 0.70389317406482510009 3.1702601281497533314 -5.9419356177983404521 -0.41368695840512420547 -2.2322165739424537634 -0.087141110526334580877 -0.44028532068897152651 3.396283024028448505;0.19617380761919003818 2.0112231211962443567 -0.68747048485604766999 -1.1050437750123742742 0.13319198704679885426 0.25330067680237045025 -0.11282572880548713545 0.013769948221298244223 -0.41103679763689182636 -1.3072960045808950102 -1.4848472726586714465 -1.422407260285807995;1.2981318587504673268 -0.63507929707837584843 0.065890702676972293106 -0.52953535701672460601 -0.16406389336423266023 0.004196801064298365247 0.68493650692720353668 -0.98101167563733238097 0.47303997788277180048 -0.6329741221230583692 -0.11150674447132921663 -0.43176105532979930368;0.75716971014905942727 -0.3671613577744572976 0.62804781870394577048 -0.54809579341660119578 -0.43267394238779421922 0.42119798248932222018 -0.90809315806148671602 0.23554930929805664719 0.23236580471903051093 -0.57460957873427065401 0.018694647942118107486 -0.64860596082952926];

% Layer 2
b2 = [1.0577470280365728339;0.63928713789655589039;3.2077633322097511837;1.0508049055985040354;-0.81734258768433898368;-0.43493805384669381731;-1.4069790787490723538;-3.1868209529526110302;-1.505144374095184201;0.76871620829635833871];
LW2_1 = [-0.89612434805628760071 0.58460377091610105094 0.094791370802993907274 -0.072027887566311052381 0.39170521455909418362 1.2760722350983715323 0.46826701746571014473 -1.1098728619765245718 1.0636610403909501077 -0.042191171002915459076 0.27318215324581024417 -0.13870545768688136157 1.2642310988151410633 0.7779121274393260288 1.082335464767169908 0.56642233296978372614 1.5523832682475962041 -1.9081824201790018591 -0.75140021987917104962 0.91728260300588582155 -1.2558331383317731245 1.9712584101788226398 -3.5608987489085355271 1.1446203305960780394 0.42441628646912293865 -0.0093139216334368387512 -4.4237939005276780691 -1.9461057161989747666 -0.79122668341285506965 -1.8777893714073894404 -0.89594830556697879764 -0.91037204216194245188 -2.7322617448250139383 -0.25060914333372014129 0.83003378631610713612 0.29671360681437208839 2.0946531298256125808 1.0065604805935108867 -0.081927465811594643585 0.82320340390189405966 -0.27447919634730932881 -0.71295539403288277214 0.60906283716190023902 -1.976295364335313387 0.16675029776766073231 0.34838296159524145823 1.589360628262334707 -2.5391343482393917697 -0.68825142583851428579 -0.096739348894011006896 -1.9508042433463288479 -2.2697734867585315222 -2.7785240362337555453 -4.7452147963741682091 -1.5288350816269262733 -0.76978926667560498842 -2.4251654234391373244 1.7833836784337087078 2.3371185496594408804 -3.5650473813229406339 -1.7138318540743262552 0.45331215110934008905 0.79275758712906252423 1.7410871965814300744 1.6269436606923421973 0.92166226479816426576 0.28162234820597781271 0.7142261256717049589 0.33364220380763320861 -1.1525861998839304068 -1.1764405063978486954 1.1616525473946768265 2.2404900180460392001 -1.8843634272920593009 -2.1019411232493068198 -2.6222950031860126074 2.3876397397198938499 -0.27521870920581747999 -4.1203725215869448917 0.27848931445106439586 -0.51506032628743725343 0.90675974733502384684 0.52712337493878513861 0.15645347000497292211 -2.2093099229826891339 -0.81935156601869796322 -0.32707467316900312726 0.97915421349600062495 -1.2930840051297938231 -0.853829260477914187 0.23247345324257859267 -0.1083734499543410057 -0.3585425519116416937 -0.35912464036551577928 1.1657402819641367042 -1.2404662962547032823 0.7917567774176328399 0.12717228873195737804 0.77996425136949576462 0.34912729923902724449;0.25535083909616701492 0.75960003798703534805 0.70733504139058944737 1.0552649105995053347 2.3225376801452637388 -2.7888419219156568296 1.0993588494393089494 1.693398744928833688 0.036489673132410194167 2.7839722793473233864 -0.5716938437695283648 -0.9061276978694051687 0.92381531009711403968 3.0654918123355168191 -1.1732144776995749869 0.32869508823033855016 0.54822193418784204155 0.82314041631329637472 -0.88116980738341477153 0.83738746112765327645 3.3511329156628262282 2.2211434741276399052 -2.2560777337087052352 -1.7514793224579388031 2.2588842131704232052 -1.3969670118146129134 0.46828827123251776099 -0.41147846480109451228 1.498351390041831932 -5.2652943500486184547 -0.43830796743156386075 -0.4780777449128521539 -0.57027999171557008928 -2.722091744341354147 -1.53685348687426937 -0.55179623781768483148 -0.59756202965066052002 4.4870490540428287218 -4.4495331718697421763 -0.87695712320241681059 0.89368244435582755436 1.5449776756654196586 0.56445556938678309589 1.6471047811377506065 1.8803756132118376598 -0.89292627876640862095 1.0231225943960364777 2.3141027654360337706 -2.4841050690640269494 -0.25942837526411466342 -1.1505731238499916635 -0.83476114822139479976 0.90907872220911767336 -0.20165385652143308359 -1.6027942882178396466 -0.62748251980226998903 2.2488534278588572235 -0.78958860569106459337 -1.3136134745131424761 0.20167261432601554794 1.5373918260047902962 3.0873125124296234567 -1.3232978350677582213 -1.4113430692978277126 1.6751775279843463817 0.91863484569994058315 -1.8168381259705224107 -0.81926021389208103507 0.063336731282291114375 -0.32203108299143995419 -3.1819391097987845818 0.97159067206230564917 1.1231447738971782613 -1.1248470608187610686 0.59110271047179252513 1.3625557503239176249 2.3763985110261155731e-05 0.19339128696072380165 3.019723434573353682 0.65735373413395359332 -0.20344869451846522845 -0.88901551111842092023 -3.757590453583362855 1.2214685508136209346 -1.534683295207310838 1.6261954163687359909 0.42829692504946947906 0.92386533718482666266 -1.3369898808226292619 -0.58726700623580785354 -0.35881734977721552182 1.3819102931502560416 -0.68140758547643909271 -0.12843254410136234478 -1.0808178372417842628 -1.1332901204232110892 1.481524329221287628 0.45915805059487641016 -0.56498189917793550929 -0.16746106962143972319;-0.081648044223890034465 -1.8582893269556266524 -0.19433296885386264208 2.4578337096771170067 -1.9015157838894638509 -3.1219118128385563438 -1.7459335983493915467 3.6138252995866912975 2.6302218125961731587 1.8424639214836524559 -0.44052788805891190949 2.146554485930238787 0.82301328149536279177 -2.3089920823576406406 -1.0821379125746073413 2.7925516884474008705 -2.7401322211706307108 3.1546115247831680861 -0.11523830150863610677 -3.7385528496217510508 -1.8780249086622899934 -0.9039156500277044648 6.1672923774073389325 -3.594321891627529908 -1.1452690036546551156 2.8141188493069968501 1.5587676452270213812 -0.51359894290810637063 2.6088948047074502767 0.92113495036782899739 0.97510135317584001324 3.3799769383004933943 -2.3671219437029114019 1.3577513714151903113 3.0934006044768325161 -0.44170407984100268362 -2.8643416466544970866 -8.965458627368388278 -0.72884165023184566135 0.40239481203744031923 1.7854612748472389328 -0.024212284915020063775 -1.3929658564363991413 -1.6454189153064637807 -2.1718154359773254036 -1.2111369137883387648 1.2654087968992047131 -1.4032541204543642621 0.50813443442472261413 1.7707571039766460963 1.0080662682218950454 1.0824897774721664589 -1.2565994378633318362 2.2631151148491350789 0.13174188464556396694 0.34511053424532045497 3.4588213384147654672 3.7297033869053377586 2.9533735501954887503 1.056344516746544393 0.0025593150805290369385 -1.7123456745791814093 0.70396517443009198889 2.5640816242077604237 -0.23316801073269713407 -2.5039432932368148599 -2.8685948689537559275 -0.29724799402381019142 2.1283501469587711163 1.7238907747796354819 1.2715704388598261243 0.82178720324220910776 -0.38434908693318731165 -0.030596373967707837099 -0.071798384401170825542 1.5026249154562076882 -3.6477055235280992918 -0.15489614966818895936 1.0941782103976271934 0.23255898991639656348 3.4264740139796532326 2.5834773012450575891 -0.84982386457576097882 -4.4849802185703220303 -0.53849843922768536597 1.6192881943008132772 0.46766265141797491722 2.0742393205814004808 5.1341224125105338061 -0.98768136489081659324 0.49525470235635782323 0.76217700700056556506 -0.014880545180084589832 -3.3326927973550608542 3.0513009807606272794 2.5315143163763877965 -6.5021597911237973832 -2.2915426887410488277 1.8814081396438346871 1.1576555986365655304;-0.44731389608170157857 -0.71166220306969185661 0.80563736140504749184 1.2810465701852702392 -2.2440362591862230701 2.1120198671367944598 -1.0377443529333036931 0.93409386355593049256 0.90908467493100830747 -1.9867771812963181954 0.0048180417663119673444 -0.57485672733500148279 0.10065309164312177814 -1.0121961135123493936 -1.8678661602373316519 1.4378954894429312183 2.5760419560747034318 -3.3741351344222314523 -0.17957563579506852225 -0.34567244147431236412 -0.69364102479261324774 2.0384681552471617394 1.4854246077113342217 2.520239532986326747 0.282565208677558799 1.9004766746145587142 -4.224857935582497781 -0.049415808550602839666 3.9611279227653488633 1.2134487453557063485 1.5307917870535239224 -3.5259715146090941928 -1.7735662452727565253 2.090280494093470498 -1.7372608215215736838 1.0891344867349359582 4.939679370119802293 0.33526866215234701896 0.13830284024905070694 -0.50143426442143756994 -1.5306923070953228905 -0.75994727893908586847 0.11053373186666134997 -1.7311110574048709232 0.43343244825610016679 0.073420530566416938867 1.7031654660268333856 -1.8468217200318848281 2.6144788588423204523 -0.23436371876444936357 5.1136955591805515198 1.1002112335077638416 1.331851075946395957 0.64376314466944295489 -0.90182251579983574441 -3.1259209702740751169 -4.6414275008666159295 1.4957167423255923744 -0.87524805253107829106 -2.821060069169790907 3.0807981435562648009 0.31535832267262475792 1.0360225473215232128 0.31172095704628993706 -1.2378011094333636333 -2.5728641365337194813 -0.69438255956986505435 -3.7372634456850200024 1.1650045669688295913 0.92025611670496176853 0.78276740828875090994 -1.2569975899266085939 -0.85229569721338205301 -1.036468532079678706 2.0715182427985121549 -3.985378318901499739 -2.4491863596643663747 -1.7229833174596134171 3.1420450085804336737 1.1146576826449574593 -3.2825356892429975453 1.8648505014243896838 1.1892460312789574495 3.9751620246269352421 -1.1464061612372660193 1.0691609804787629567 -3.7223514744607282267 0.37558037397898513809 2.265439528123426971 0.9831539029849395428 -3.288801614839864218 -3.9409472464286898763 -1.8736379386182251405 -1.0720939487519256517 1.6174583918933982396 0.94733754196843589224 2.2380447430986474266 -1.1085541558726630385 2.0085576418561217338 1.742655427519909983;1.4711653345068722576 1.1600258439197239646 -0.95703614481579246664 -0.21376195832356775783 -2.775992255342076831 -0.61890670302266048708 1.8077924854625788686 -1.9277165550677874961 -0.38960145034014548315 -1.7266157300369702199 1.3367010339362666027 -0.97277711358727014801 -6.4844940325726287966 -1.2046159143341983455 -0.98005027381337339598 -1.3395120171040399981 -1.0444176289364179855 2.2882817856102248832 1.5087362656582390397 0.51549656015324440972 0.095159252928361220958 -2.2482840857845420857 3.0324510360751113502 0.85693205372024561228 -1.1384848570842796001 0.41379431134924854474 5.0222108458011796017 -4.7808673315115388647 -0.30729010733796618959 1.2378980415468396892 -3.2111426527111954776 2.2888280987685636347 3.7093063406694368744 2.80693068193886619 3.259635278512476031 -1.1981746874404302083 -0.17261815860453977312 0.39301269335921945602 1.6462018098942938771 0.088857887721642506151 -1.8619072438743755615 0.42352530181148528854 0.67479600699119834939 -1.8968196442827103265 3.5631549002306250884 3.5458723365754920565 -0.44385113522465385882 1.1535871636417431851 -3.0739105129701149721 -1.3382600454476165641 -1.7702116306734467788 3.4059197748419927088 3.729724336609542501 4.0891926878698727776 -0.69332147720656389644 -0.42844841386170895436 -3.6657843099465936554 2.0084431039307015787 -0.41095990197175419345 -1.3793142962978368615 -1.6961097616647080599 -5.2366722715788895925 1.4904951422728884847 -0.391504517070758562 -1.0376575665882601385 1.4827701173535428048 2.2563406956398242009 0.0043321629385006639804 -1.1266812086408914961 1.8558217427202028382 2.5069208308218149384 2.742104473771374451 -2.0647719276551259604 1.1832120737091800233 2.6921345407962271601 0.85189929683662879434 -5.5619904915042583937 -0.60620334129959851932 -0.9758783932563454 -5.6284406964493562953 4.3764800168832413974 -1.3703804959333893976 0.79352092897438741836 1.9669919673162135076 2.2958967378012586913 -1.4932452272572080965 2.9245457864646633439 -1.6737055733745154207 -3.8381675412384028689 -1.0746756007143625222 0.67845611988241294465 -1.7745642733226045795 1.5364328909097006992 1.081052098230712355 -0.92393044270782320737 -0.59724938130035321038 -0.86055904129193661056 0.086275325299714086813 -0.56001317540839734566 -0.54139053595919706119;-0.86570568200555808591 -0.13892919856163407633 1.9811079766646912947 1.2689268337945538434 -0.1429283504250004333 -0.24882638318364602714 1.1444189706083391922 -1.350273110877202587 0.52763819935818490059 -1.1458441947132549377 -1.8728765067688695201 0.79323269503929272339 -2.0323607891386719082 -2.043416384606114633 3.2989895681226606428 -0.20495917568972377154 -1.3407180559275295728 0.70853850526805461918 2.0147420081757392296 -2.6668087143801284533 -3.4624909568621897726 3.7458934280446811727 0.98553971170243026556 4.703956593574119438 0.12982343597227993803 -2.9809718849096453752 0.57916939828944624669 -4.4083031932277805254 -3.0381324001508915877 1.671013481652909638 4.1782573459256440174 -0.83008059223578922747 2.2847005717186550378 0.57145148478224905286 -1.8946156985304682951 0.46434617003568356974 0.98382953495506475505 0.015110160342194383157 -1.0933035917393958414 -3.7060946096502460634 -0.56116534654331540199 1.950493520116144408 1.085491229308705563 -2.6938537049921529309 0.31614868719051703039 3.431399444508524077 -1.0519169311128899746 -1.1725891461304567276 0.17672155418633739288 -3.1686691834476681251 -3.3939853070020080672 0.99272698064906161886 2.4025636349752219623 3.714263969765936757 3.6197366043342436015 0.13208186954400294444 -0.38571399929650601601 -2.3947062272708552477 -2.4865359313770394323 1.047346092270587059 -4.7819920550155590178 -3.2130019890139012162 2.3221843436642437553 1.2399648870594566219 0.39760035746481264818 1.3389329058377792414 0.70030630607273314236 -1.8582508700681066305 0.10523303406007664118 -0.57116470138668151701 2.8653315089085706902 -0.66623089107133282027 -1.7187009507865491642 0.87644514044421795163 -2.3877336544192502288 -0.60909328973199816648 1.6010108015209834065 1.7021432264308391513 1.0924612568130465107 -1.0836337076525475176 0.7586932669493051673 0.69979816055202581637 -0.98968750326799559414 -0.45642656455733215948 0.37903197294530788231 -0.81050924832298720801 -0.45820982638106061424 0.81758076361788878383 0.1807880865396805925 0.44046982994801037181 -1.5333582425850327269 1.7155555488352882687 -2.0901368968876550269 -1.5072811490986812721 0.54154001821235508984 0.88163729629246156971 4.2510606219348012758 0.94829120987053316938 0.040373840714944458918 0.44685656608291912661;1.1817087645596422441 0.0099536589194143543224 0.23719792323608659967 -0.29478498403072106449 0.72520325498493187766 -1.0211712885294457198 1.1901671031815599378 0.3530922442385369675 -1.2841079823965926288 0.96281543916351131074 0.85914636589530302135 -0.42069148621601032412 -1.0507707038849352088 0.53147967295190345904 -1.523847307958426045 0.34962898764928596052 0.55789143042220490365 -0.70529702628982438029 0.90598959910664023099 0.51657110184989574186 -4.1970777181926237631 -1.3609066036932699895 -1.5466659557991040419 0.06386000031527699905 -1.5408336201863641612 0.085370148999791367617 1.1994170837507129868 -0.91502625408774085347 0.075932893438291487742 0.016307356137076102487 -0.22455295672499600568 4.0934921268968516017 -2.6921753515961914793 -3.6397279089126493012 0.62136397540860544009 -0.15974679465004229528 3.0371308865380455266 0.76615197871871887347 2.3692405662152395962 -3.8789139299840762476 -1.7414363948390843007 -3.3309468069651160249 -0.091795699696427049408 2.3751802383734235136 -1.994803395842159377 -3.4768602111781690134 0.22366199589089449939 -3.1371204016376847967 1.8091942692418243599 1.7168041838318355286 3.7230925593814157004 -3.9978027907903963545 -3.4608787370272056094 2.2412238448741899077 0.14377210240039708933 1.1846621060754232158 1.3363561411665074719 -0.85096471687481345381 0.74168551059307830098 0.26957247656625710208 0.90784657313270156198 0.078065215795062939397 0.5858942121219795629 -1.3678760286046001138 1.1542761229300892989 0.44809427133004670063 1.0768697458576652615 0.46834827622002617176 -0.11493763836782067145 2.1398315075697285081 3.0090194321878391825 -2.4059697887801068106 2.2015981204522794279 -3.0753135680091698845 -2.3355197599622310456 3.3049459740667175289 1.310722546144005074 -0.11137644827402877479 2.3630207002706025143 1.6728654782715903782 1.0881439982923124532 -0.93994273302583941643 -0.054210942158134656221 -1.3502051398075156641 3.4339470780700889208 -1.8915125142271300707 0.86777539538796755192 -0.63756583136031108605 0.6600162267713592934 -0.98435621466864897666 0.21159758092138158947 2.1089472758001561736 -0.31234053754509760736 0.39346970737038294841 -0.61379345476344437937 -0.049249136792957275144 0.28059550448117076549 -0.080957343273664883476 -1.3657186066411217684 -0.53839755403861622174;2.0955518051034065508 2.1396820760807111483 -3.1762118631954234793 -1.458186526828852525 2.7150665002446383589 -1.1608897169845187047 2.2893579660268565945 1.5940096504196870075 -1.7687669464101538619 -2.4705230703350888888 -1.7219297648401297174 -1.0542380173506200602 -0.93253794907274756287 0.44404960069961202374 3.0269704288348995291 -1.7425633368199220374 1.7774385931757397117 1.8419654989643556853 -0.2926182366082542563 0.66499272605278014758 2.1474640371675595141 -1.4880436671840531204 -3.7007851368455377816 -1.6929133993201956887 -1.9596273390110772183 -0.44011052308110409914 -1.3673308108145532103 6.8553972662306223995 -0.66171111054835629606 1.3390763260875062635 0.2708719866472177884 -2.0086253754424219231 0.71904562141871963821 -0.71670422495584584777 2.6337982315695822599 -1.0395968108230608795 -1.0195979117325801866 3.27595129104356797 5.4233723833654146063 3.8830539190106936331 0.063868583348584473391 4.9403696858063206321 -3.5940666758341137665 1.8646969488951423699 -3.9550591913614256967 0.52490106603361119664 -2.9768499946246049781 1.7890043295369875143 1.3005075834321990769 2.398252844467266609 1.7123725059095249446 2.2166253611563688786 -1.4248813496658709887 -3.5621920534699129668 0.3380061947532088662 0.64545166011324117683 2.8176602423864132163 -0.5607456241938092445 -3.9370970037699852817 0.70931721865968411223 -2.1384019168520702614 0.9301778503830042677 -1.3429818398985178263 2.7993942706412648924 -0.83430431200482091381 4.3477217469948197248 -0.93176202778769345869 3.8308702846973301526 -0.010533324248745021268 -3.376434970684138559 -4.1241418142250809709 0.75424988895215439033 -1.0792278398252854732 1.6366168933845202105 -1.2579982870226060765 -1.801956603552050229 1.935220216895544576 0.95951213163011128682 -2.9056125938059307323 0.26910124555754116882 -0.63464561484027104399 -1.1195998004083702604 5.9038380897722788632 -0.82131791770041573386 0.74196789397061735372 0.55742908625795350996 2.7837763447638459446 -1.1747260502190357556 -2.085382823600656188 -1.5849769967401579063 0.38471283872227690637 -1.1680189806652316875 -0.93522978886118401931 2.2113661130429651536 -3.147870586915100688 -1.6138543263044553555 1.0787905288034405071 1.9720237176429404879 -2.4823373790329683608 -1.9046413020512262815;-0.50961102370273958506 0.68495541463298736939 -1.6063669418413621948 0.53551271926605514828 0.84305292153208288841 3.1294510029912179228 0.18111283634658467689 -1.7028484517584248081 -1.3990857413547697075 1.7504537334119911751 1.3098517462225660601 -0.2446517527911072909 3.7168753903569906605 3.4144199830060473211 -0.33192497136642290512 0.33241333186084848217 1.2733335217436407838 -2.1250116579994324795 -1.7796047034950053245 -1.5614693264832926189 0.75528741632598561662 -4.1626945868346103552 0.50185967994285951566 -0.88234298703710445366 3.9730980437789327198 -2.74768767989999807 -1.1114480551867214064 -0.03418299763779612116 -3.0305846784696099938 -0.78965593053661431444 -2.7638315753670430475 1.3051973560686116471 0.50471331398916907673 1.074002114342863079 -3.0295685938904677315 -0.51223582224075892011 -5.6617098205053526527 -1.9206556698680559148 -3.1761628815282882954 -1.2791326751455287525 0.85826948639653322104 1.7996749152540238992 0.9881559277271710906 1.1135680913787746604 0.46030818202718248866 -0.63991460254560472709 0.61002558163194431362 -0.35930061932071827302 -2.2269182898440851304 -0.33048341209152021225 -0.40509956213183223594 -0.80402750506041331668 2.2774967089744952986 0.46308322323410777699 0.64077102672134511607 -0.38080945592861353832 1.5890841292378243832 -0.26173917964261939062 0.10668849815720861385 0.10491717971980624169 0.41826887640725257667 0.68420788903076479315 -3.8207066060158219045 -2.6576893638480814097 -0.14317654089145984142 -3.2359690346352585344 3.3594549264926580889 5.8070604889851988872 -4.1486012711604658421 -3.0325101251228354649 0.47067303597020515582 -1.5316101661689323077 2.9596007589013266781 1.7014551507659276819 1.888272635506081043 2.873145565746012764 -0.19929709154398539406 -2.6348067181601733111 3.117185529623629936 1.9854546614078265598 -0.87109714533732895969 -0.32522417725141067324 -0.42015089013838724519 3.604785881113306889 -0.033163018775673874794 4.8465519227183087025 -1.9253610661445408336 -0.11897689048093772202 0.15840356746501976781 0.66853496561205183468 2.3452723829130857069 -0.49287615149304608853 3.032663553801538292 0.70758731009794495481 0.1223273216913609851 -1.55307985748052646 -0.63591015808003681364 1.6329641846338149858 -0.12543688875269662364 -0.96120662189027439304;-0.76129582424201525104 -0.28427999388429570082 0.58052694312469299565 -0.20158871392158339564 1.9331153042676731957 3.3361533455468412868 -1.2556883679878871884 -0.71877136525769225184 1.0530048302709049679 1.899595577573159888 1.3771639712896615038 0.10188853348680168565 1.6197992604539581674 -0.9053585030713882098 -1.551839138259706985 0.092840408361394025083 -1.5925458943316417315 -0.1131194064299529678 1.4791968436267093345 3.4411327504408615319 0.94235788792708219397 0.5208800320248586635 -0.11909266011026647947 0.1574119755292422429 -0.24999827375785899086 -0.34663927513461761931 -0.0099547742858369127339 -0.58316785869073251014 -0.69030771571275761911 2.2292104288163949732 1.0149042993530621448 -0.86360831834457729705 -0.89099700068145903931 -1.4462236751653847477 -1.2149581370181554707 -0.12689121272122613759 -1.3109189831406602433 2.7175515957116518351 -1.4522659947522367219 2.6307347400142884197 0.46436929199716120431 -2.6293899321036717787 1.704802508579222442 2.9765962169926267755 1.6151730851923900012 -0.73910430998208842546 -1.4681425845460971402 3.5130315281903681246 2.0547503259361499239 0.25706900248533581799 -1.3363958300792218026 -0.3761691410200760366 1.286253127589983114 -2.4639319827535643981 -0.92235613161611729183 0.12771005245567240705 0.61588501035732567956 -0.55213885955403263495 1.4250594810885546249 0.62692001700853072776 2.131889417493826322 5.6201133505040994365 0.5940386692307034755 -3.587888102951206637 -1.5643420609651710329 1.1371670379287264208 -0.51543063897895058378 -0.50120432264288017343 0.51101771565172871004 -1.8738926833268332306 -1.343720134493608942 0.90465637606412729887 0.94298901502999088464 -0.56844697582248981949 3.3968217390657926558 0.42472561266298697324 2.2378423289462832102 1.0153710081200757465 -3.0876656141027845059 0.83127091686404075421 -2.3469982488945517751 0.84150425733167077968 -0.87452256244595494294 -3.510078257654270395 -1.8033436079805620356 -0.49191920151427548369 1.5851959806397559749 0.9350852683803110299 -0.22319512964946711109 0.94624855141934771652 1.9457588588724008538 -0.51073490938803234318 3.4182942202687112143 0.02205507206792626379 -0.098063583088065064963 1.9779712458365310557 -2.4138568620141080956 0.70185239361289908366 1.0563942807349375741 0.88040987946592730307];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
    X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},1); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    X{1,ts} = X{1,ts}';
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = softmax_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Output 1
    Y{1,ts} = a2;
    Y{1,ts} = Y{1,ts}';
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
    Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Competitive Soft Transfer Function
function a = softmax_apply(n,~)
if isa(n,'gpuArray')
    a = iSoftmaxApplyGPU(n);
else
    a = iSoftmaxApplyCPU(n);
end
end
function a = iSoftmaxApplyCPU(n)
nmax = max(n,[],1);
n = bsxfun(@minus,n,nmax);
numerator = exp(n);
denominator = sum(numerator,1);
denominator(denominator == 0) = 1;
a = bsxfun(@rdivide,numerator,denominator);
end
function a = iSoftmaxApplyGPU(n)
nmax = max(n,[],1);
numerator = arrayfun(@iSoftmaxApplyGPUHelper1,n,nmax);
denominator = sum(numerator,1);
a = arrayfun(@iSoftmaxApplyGPUHelper2,numerator,denominator);
end
function numerator = iSoftmaxApplyGPUHelper1(n,nmax)
numerator = exp(n - nmax);
end
function a = iSoftmaxApplyGPUHelper2(numerator,denominator)
if (denominator == 0)
    a = numerator;
else
    a = numerator ./ denominator;
end
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end
